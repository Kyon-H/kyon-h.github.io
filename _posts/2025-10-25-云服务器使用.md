---
layout: post
title: 云服务器使用
subtitle: 云服务器使用
date: 2025-10-25 23:32
author: Kyon-H
header-img: img/post-bg-2015.jpg
tags: 
number headings: first-level 2, max 4, 1.1., auto
published: false
---
> [!配置]
> 
> 运营商名：aliyun
> 系统版本：Debin 11
> 系统配置：2 核 2G，40G，峰值带宽 200Mbps

## 1. 更改系统名

```shell
hostname debin-yun # 临时修改
hostnamectl # 查看系统名
hostnamectl set-hostname debin-yun # 永久修改
```

退出重新连接即显示新名称

检查 hosts 文件主机名

```shell
cat /etc/hosts
```

若还显示原名称，则手动更改

```
127.0.0.1 debin-yun
```

## 2. 安装 Docker

1. 更新现有的软件包和包缓存

```shell
apt update
apt upgrade
```

2. 安装依赖包

```shell
sudo apt install apt-transport-https ca-certificates curl software-properties-common
```

3. 添加 Docker 官方的 GPG 密钥

```shell
sudo curl -fsSL https://download.docker.com/linux/debian/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc
```

<mark style="background: #FFB86CA6;">报错</mark>：`curl: (35) OpenSSL SSL_connect: Connection reset by peer in connection to download.docker.com:443 `

<mark style="background: #FFB86CA6;">解决方法</mark>：更新 CA 证书

```shell
update-ca-certificates
```

<mark style="background: #FFB86CA6;">报错</mark>：`curl: (23) Failure writing output to destination`

<mark style="background: #FFB86CA6;">解决方法</mark>：先下载到 `/tmp` 目录，再移动到指定目录

```shell
sudo curl -fsSL https://download.docker.com/linux/debian/gpg -o /tmp/docker.asc
sudo mv /tmp/docker.asc /etc/apt/keystrings/
sudo chmod a+r /etc/apt/keystrings/docker.asc
```

4. 添加 Docker 官方的 APT 软件源

```shell
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/debian $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
# 更新
sudo apt-get update
```

<mark style="background: #FFB86CA6;">报错</mark>：
```
Err:7 https://download.docker.com/linux/debian bullseye InRelease
  Could not handshake: Error in the pull function. [IP: 3.170.229.96 443]
```

**由于网络问题无法在线安装 Docker，选择离线安装方式，先下载安装包到本地再上传到服务器安装**

### 2.1. 离线安装 Docker

选择安装版本： [Index of linux/static/stable/x86_64/](https://download.docker.com/linux/static/stable/x86_64/)

[docker-28.3.3](https://download.docker.com/linux/static/stable/x86_64/docker-28.3.3.tgz)

传输到服务器后·解压

```shell
tar xzvf docker-28.3.3.tgz
```

停止 Docker 服务

```shell
systemctl stop docker
systemctl stop docker.socket
systemctl stop containerd.service
```

覆盖旧版本

```shell
sudo cp docker/* /usr/bin/
```

启动 Docker

```shell
systemctl start containerd.service
systemctl start docker
# 查看版本
docker --version
```

### 2.2. 离线安装 docker-compose

地址：[Releases · docker/compose](https://github.com/docker/compose/releases)

https://github.com/docker/compose/releases/download/v2.26.1/docker-compose-linux-x86_64

上传到服务器上后替换原文件

```shell
mv docker-compose-linux-x86_64 /usr/bin/docker-compose
chmod +x /usr/bin/docker-compose
# 查看版本
docker-compose -v
# 创建软链接
ln -s /usr/bin/docker-compose /usr/local/bin/docker-compose
```

## 3. 安装 1Panel v2

```shell
bash -c "$(curl -sSL https://resource.fit2cloud.com/1panel/package/v2/quick_start.sh)"
```

## 4. 安装雷池

### 4.1. 环境依赖

安装雷池前请确保你的系统环境符合以下要求

- 操作系统：Linux
- CPU 指令架构：x86_64, arm64
- CPU 指令架构：x86_64 架构必须支持 ssse3， 推荐支持 avx2指令集
- 软件依赖：Docker 20.10.14 版本以上
- 软件依赖：Docker Compose 2.0.0 版本以上
- 最低资源需求：1 核 CPU / 1 GB 内存 / 5 GB 磁盘

可以根据以下命令来查看相关信息

```shell
uname -m                                    # 查看指令架构
cat /proc/cpuinfo| grep "processor"         # 查看 CPU 信息
lscpu | grep ssse3                          # 确认 CPU 是否支持 ssse3 指令集
lscpu | grep avx2                          # 确认 CPU 是否支持 avx2 指令集
docker version                              # 查看 Docker 版本
docker compose version                      # 查看 Docker Compose 版本
docker-compose version                      # 查看老版本 docker-compose 版本
free -h                                     # 查看内存信息
df -h                                       # 查看磁盘信息
```

### 4.2. 在线安装

```shell
bash -c "$(curl -fsSLk https://waf-ce.chaitin.cn/release/latest/manager.sh)"
```

